{
  "scan_date": "2025-10-12T02:18:12.801701",
  "total_vulnerabilities": 52,
  "by_severity": {
    "MEDIUM": 11,
    "HIGH": 4,
    "CRITICAL": 36,
    "LOW": 1
  },
  "vulnerabilities": [
    {
      "name": "CSRF Token Missing",
      "endpoint": "meu_app/routes.py",
      "line": 64,
      "code_snippet": "@bp.route('/login', methods=['GET', 'POST'])",
      "severity": "MEDIUM",
      "description": "Rota POST sem verificação CSRF explícita",
      "recommendation": "Implemente validação de CSRF token em todas as rotas POST"
    },
    {
      "name": "CSRF Token Missing",
      "endpoint": "meu_app/pedidos/routes.py",
      "line": 72,
      "code_snippet": "@pedidos_bp.route('/novo', methods=['GET', 'POST'])",
      "severity": "MEDIUM",
      "description": "Rota POST sem verificação CSRF explícita",
      "recommendation": "Implemente validação de CSRF token em todas as rotas POST"
    },
    {
      "name": "CSRF Token Missing",
      "endpoint": "meu_app/coletas/routes.py",
      "line": 56,
      "code_snippet": "@coletas_bp.route('/processar/<int:pedido_id>', methods=['GET', 'POST'])",
      "severity": "MEDIUM",
      "description": "Rota POST sem verificação CSRF explícita",
      "recommendation": "Implemente validação de CSRF token em todas as rotas POST"
    },
    {
      "name": "CSRF Token Missing",
      "endpoint": "meu_app/usuarios/routes.py",
      "line": 11,
      "code_snippet": "@usuarios_bp.route('/', methods=['GET', 'POST'])",
      "severity": "MEDIUM",
      "description": "Rota POST sem verificação CSRF explícita",
      "recommendation": "Implemente validação de CSRF token em todas as rotas POST"
    },
    {
      "name": "CSRF Token Missing",
      "endpoint": "meu_app/financeiro/routes.py",
      "line": 62,
      "code_snippet": "@financeiro_bp.route('/pagamento/<int:pedido_id>', methods=['GET', 'POST'])",
      "severity": "MEDIUM",
      "description": "Rota POST sem verificação CSRF explícita",
      "recommendation": "Implemente validação de CSRF token em todas as rotas POST"
    },
    {
      "name": "Hardcoded Secrets",
      "endpoint": "meu_app/templates/base.html",
      "line": 9,
      "code_snippet": "[REDACTED]",
      "severity": "HIGH",
      "description": "Token hardcoded",
      "recommendation": "Use variáveis de ambiente ou arquivos de configuração seguros para credenciais"
    },
    {
      "name": "CSRF Token Missing",
      "endpoint": "meu_app/log_atividades/routes.py",
      "line": 103,
      "code_snippet": "@log_atividades_bp.route('/limpar', methods=['POST'])",
      "severity": "MEDIUM",
      "description": "Rota POST sem verificação CSRF explícita",
      "recommendation": "Implemente validação de CSRF token em todas as rotas POST"
    },
    {
      "name": "CSRF Token Missing",
      "endpoint": "meu_app/estoques/routes.py",
      "line": 24,
      "code_snippet": "@estoques_bp.route('/novo', methods=['GET', 'POST'])",
      "severity": "MEDIUM",
      "description": "Rota POST sem verificação CSRF explícita",
      "recommendation": "Implemente validação de CSRF token em todas as rotas POST"
    },
    {
      "name": "CSRF Token Missing",
      "endpoint": "meu_app/clientes/routes.py",
      "line": 30,
      "code_snippet": "@clientes_bp.route('/novo', methods=['GET', 'POST'])",
      "severity": "MEDIUM",
      "description": "Rota POST sem verificação CSRF explícita",
      "recommendation": "Implemente validação de CSRF token em todas as rotas POST"
    },
    {
      "name": "CSRF Token Missing",
      "endpoint": "meu_app/produtos/routes.py",
      "line": 22,
      "code_snippet": "@produtos_bp.route('/novo', methods=['GET', 'POST'])",
      "severity": "MEDIUM",
      "description": "Rota POST sem verificação CSRF explícita",
      "recommendation": "Implemente validação de CSRF token em todas as rotas POST"
    },
    {
      "name": "CSRF Token Missing",
      "endpoint": "meu_app/apuracao/routes.py",
      "line": 63,
      "code_snippet": "@apuracao_bp.route('/nova', methods=['GET', 'POST'])",
      "severity": "MEDIUM",
      "description": "Rota POST sem verificação CSRF explícita",
      "recommendation": "Implemente validação de CSRF token em todas as rotas POST"
    },
    {
      "name": "Cross-Site Scripting (XSS)",
      "endpoint": "tests/security/test_csp.py",
      "line": 237,
      "code_snippet": "rendered = render_template_string(template)",
      "severity": "MEDIUM",
      "description": "render_template_string sem escape",
      "recommendation": "Sempre escape dados do usuário antes de renderizar. Evite |safe e |raw a menos que necessário"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/wheel/vendored/packaging/_parser.py",
      "line": 334,
      "code_snippet": "value = ast.literal_eval(python_str)",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_internal/utils/setuptools_build.py",
      "line": 12,
      "code_snippet": "exec(compile('''",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_internal/utils/setuptools_build.py",
      "line": 46,
      "code_snippet": "exec(compile(setup_py_code, filename, \"exec\"))",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_vendor/packaging/_parser.py",
      "line": 332,
      "code_snippet": "value = ast.literal_eval(python_str)",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_vendor/packaging/licenses/__init__.py",
      "line": 100,
      "code_snippet": "invalid = eval(python_expression, globals(), locals())",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_vendor/pygments/lexers/__init__.py",
      "line": 154,
      "code_snippet": "exec(f.read(), custom_namespace)",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_vendor/pygments/formatters/__init__.py",
      "line": 91,
      "code_snippet": "this method is equivalent to running ``eval()`` on the input file. The formatter is",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_vendor/pygments/formatters/__init__.py",
      "line": 103,
      "code_snippet": "exec(f.read(), custom_namespace)",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_vendor/distlib/scripts.py",
      "line": 163,
      "code_snippet": "# shebang, or else using os.exec() to run the entry script will",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_vendor/rich/markup.py",
      "line": 190,
      "code_snippet": "meta_params = literal_eval(parameters)",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_vendor/pkg_resources/__init__.py",
      "line": 1714,
      "code_snippet": "exec(code, namespace, namespace)",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pip/_vendor/pkg_resources/__init__.py",
      "line": 1725,
      "code_snippet": "exec(script_code, namespace, namespace)",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/launch.py",
      "line": 32,
      "code_snippet": "exec(code, namespace)",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/build_meta.py",
      "line": 317,
      "code_snippet": "exec(code, locals())",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/wheel.py",
      "line": 190,
      "code_snippet": "def eval(req, **env):",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/wheel.py",
      "line": 211,
      "code_snippet": "(req for req in reqs if for_extra(req) and eval(req, extra=extra)),",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_vendor/typing_extensions.py",
      "line": 1215,
      "code_snippet": "(unless you are familiar with how eval() and exec() work).  The",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_vendor/typing_extensions.py",
      "line": 1215,
      "code_snippet": "(unless you are familiar with how eval() and exec() work).  The",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_vendor/packaging/_parser.py",
      "line": 332,
      "code_snippet": "value = ast.literal_eval(python_str)",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_vendor/packaging/licenses/__init__.py",
      "line": 100,
      "code_snippet": "invalid = eval(python_expression, globals(), locals())",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_vendor/jaraco/functools/__init__.py",
      "line": 522,
      "code_snippet": "return eval(use)",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_vendor/wheel/vendored/packaging/_parser.py",
      "line": 334,
      "code_snippet": "value = ast.literal_eval(python_str)",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_vendor/more_itertools/recipes.py",
      "line": 992,
      "code_snippet": "def polynomial_eval(coefficients, x):",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_vendor/more_itertools/recipes.py",
      "line": 999,
      "code_snippet": ">>> polynomial_eval(coefficients, x)",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/config/expand.py",
      "line": 72,
      "code_snippet": "ast.literal_eval(value)",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/tests/test_extern.py",
      "line": 15,
      "code_snippet": "pickle.loads(pickle.dumps(Distribution()))",
      "severity": "HIGH",
      "description": "pickle.load pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/tests/test_egg_info.py",
      "line": 277,
      "code_snippet": "install_cmd_kwargs = ast.literal_eval(val)",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/tests/test_editable_install.py",
      "line": 449,
      "code_snippet": "exec(finder, loc, loc)",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/tests/namespaces.py",
      "line": 34,
      "code_snippet": "assert ast.literal_eval(args)  # ensure it is valid Python",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/tests/config/test_pyprojecttoml.py",
      "line": 98,
      "code_snippet": "\"__main__.py\": \"def exec(): print('hello')\",",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_distutils/core.py",
      "line": 228,
      "code_snippet": "'script_name' is a file that will be read and run with 'exec()';",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_distutils/core.py",
      "line": 268,
      "code_snippet": "exec(code, g)",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/setuptools/_distutils/compilers/C/base.py",
      "line": 1120,
      "code_snippet": "if lib_type not in eval(expected):",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pkg_resources/__init__.py",
      "line": 1738,
      "code_snippet": "exec(code, namespace, namespace)",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": ".venv/lib/python3.13/site-packages/pkg_resources/__init__.py",
      "line": 1749,
      "code_snippet": "exec(script_code, namespace, namespace)",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Cross-Site Scripting (XSS)",
      "endpoint": "auditoria/security_audit.py",
      "line": 90,
      "code_snippet": "(r'Markup\\(', 'Uso de Markup() requer validação', 'LOW'),",
      "severity": "LOW",
      "description": "Uso de Markup() requer validação",
      "recommendation": "Sempre escape dados do usuário antes de renderizar. Evite |safe e |raw a menos que necessário"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": "auditoria/security_audit.py",
      "line": 174,
      "code_snippet": "(r'pickle\\.load', 'pickle.load pode executar código arbitrário', 'HIGH'),",
      "severity": "HIGH",
      "description": "pickle.load pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": "auditoria/security_audit.py",
      "line": 176,
      "code_snippet": "(r'eval\\(', 'eval() pode executar código arbitrário', 'CRITICAL'),",
      "severity": "CRITICAL",
      "description": "eval() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Insecure Deserialization",
      "endpoint": "auditoria/security_audit.py",
      "line": 177,
      "code_snippet": "(r'exec\\(', 'exec() pode executar código arbitrário', 'CRITICAL'),",
      "severity": "CRITICAL",
      "description": "exec() pode executar código arbitrário",
      "recommendation": "Use métodos seguros de deserialização (json.loads, yaml.safe_load)"
    },
    {
      "name": "Command Injection",
      "endpoint": "auditoria/security_audit.py",
      "line": 196,
      "code_snippet": "(r'os\\.system\\(', 'os.system() com input não validado', 'HIGH'),",
      "severity": "HIGH",
      "description": "os.system() com input não validado",
      "recommendation": "Evite shell=True. Use lista de argumentos e valide todos os inputs"
    }
  ]
}